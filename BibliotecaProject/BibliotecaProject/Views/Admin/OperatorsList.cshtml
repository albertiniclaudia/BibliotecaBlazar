@model IEnumerable<User>
<div>
    <div class="row mb-3">
        <div class="col-12 mb-3">
            <h1>Operatori Della Tua Biblioteca</h1>
        </div> 
        
        <div class="col-2">
            <label for="Role">Type Of Books Filter</label>
            <select class="btn btn-primary" form="merg" name="Role" id="Role">   
                    <option value="User">User</option>
                    <option value="Librarian">Bibliotecario</option>
                    <option value="Admin">Admin</option>
                @if (string.IsNullOrEmpty(@ViewBag.parameter1))
                {
                    <option value="" selected hidden>Seleziona</option>
                }else {
                     <option value=@ViewBag.parameter1 selected hidden>@ViewBag.parameter1</option>
                     <option value="">Nessun Filtro</option>
                }
            </select>
        </div>
        <div class="col-1"></div>
        <div class="col-3">
            <input type="text"  class="form-control" name="search" id="search" placeholder="search..." aria-label="Search">
        </div>
        <div class="col-2">
        <form method="get" id="merg">
            <input class="btn btn-success" type="submit" value="Cerca"/>
        </form>
        
        </div>
        
        <div class="col-2">
            <a class="btn btn-success" asp-area="" asp-controller="Admin" asp-action="AddAdmin">Aggiungi Amministratore</a>
        </div>
        <div class="col-2">
            <a class="btn btn-success" asp-area="" asp-controller="Librarian" asp-action="AddUser">Aggiungi Utente</a>
        </div>
        
    </div> 
    <table class="table">
        <thead>
            <th>Nome</th>
            <th>Cognome</th>
            <th>Email</th>
            <th>Role</th>
        </thead>
        @foreach (var item in Model){
            <tr>
                <th scope="row">@item.Name</th>
                <th scope="row">@item.Surname</th>
                <th scope="row">@item.Email</th>
                <th scope="row">@item.Role</th>
                <th>@if(item.Role == "User"){
                        <a class="btn  btn-warning" asp-controller="Librarian" asp-action="EditUser" asp-route-id=@item.Id>Edit</a>
                    }else{
                        <a class="btn  btn-warning" asp-controller="Admin" asp-action="EditAdmin" asp-route-id=@item.Id>Edit</a>
                    }
                    @Html.ActionLink("Delete","DeleteAdmin",new {id = @item.Id}, new { @class = "btn btn-danger"})
                </th>

            </tr>
        }
    </table>

</div>


@section Scripts{

    <script>

        $(document).ready(function () {

            $("#search").keydown(function () {

                var searchValue = $(this).val();

                $("table tr").each(function(results) {

                    if(results !== 0){

                        var title = $(this).find("th:nth-child(1)").text();

                        if(title.indexOf(searchValue) !== 0 && title.toLowerCase().indexOf(searchValue.toLowerCase()) < 0){

                            $(this).hide();

                        }else{

                            $(this).show();
                        }

                    }

                });

            });
        });

         $(document).ready(function () {

            $("#Role").change(function () {

                var roleValue = $(this).val();

                $("table tr").each(function(results) {

                    if(results !== 0){

                        var role = $(this).find("th:nth-child(4)").text();

                        if(role.indexOf(roleValue) !== 0 && role.toLowerCase().indexOf(roleValue.toLowerCase()) < 0){

                            $(this).hide();

                        }else{

                            $(this).show();
                        }

                    }

                });

            });
        });


    </script>
    }

